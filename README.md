# Краткое описание проекта

Шаблон для быстрого создания проектов 1С.

## Требуемое программное окружение

* Git
* [OneScript](https://oscript.io) с библиотеками: gitsync, v8runner

## Состав проекта

```text
bootstrap-1c/
├── build/
├── doc/
├── examples/
├── features/
├── lib/
├── src/
├── test/
├── tools/
├── web/
├── .bsl-language-server.json
├── .gitlab-ci.yml
├── feature.bat
├── README.md
└── sonar-project.properties
```

### Расшифровка

#### Каталоги

`./build` - для хранения файловых баз данных, файлов хранилища конфигурации и т. д., используемых в процессе разработки и тестирования. Данные из этого каталога не выкладываются в удаленный репозиторий, поэтому должны быть добавлены в `.gitignore`;

`./doc` - для хранения файлов документации в формате Markdown. Содержит рекомендации разработчикам и команде проекта, описание релизов (RELEASE NOTES) и оперативного плана (ROADMAPS). **Не используется** для хранения пользовательских инструкций;

`./examples` - для хранения примеров кода c расширением bsl и хранения текстовых описаний на языках Gherkin и Markdown;

`./features` - для хранения feature-файлов на языке Gherkin (BDD);

`./lib` - для хранения внешних отчетов и обработок необходимых для работы продукта, разработанные в рамках создания продукта и не являющиеся сторонними разработками;

`./src` - для хранения исходного кода в текстовом формате. Для обычных форм файлы .bin должны быть распарсены до файлов модуля формы;

`./test` - для хранения тестов (TDD);

`./tools` - для хранения любых сторонних утилит, необходимых для настройки проекта или для дополнительной установки, например:

* allure
* oscript
* powershell
* wget
* ...

##### Windows

Для установки через командную строку в Windows используется http://chocolatey.org

##### Linux

В зависимости от установленной операционной системы - используется пакетные менеджеры `deb` или `yum`.

`./web` - для хранения настроек веб-серверов;

#### Файлы

`.bsl-language-server.json` - [конфигурационный файл с настройками LSP сервера](https://1c-syntax.github.io/bsl-language-server/#configuration);

`.gitignore` - для скрытия файлов и папок от системы контроля версий Git;

`.gitlab-ci.yml` - файл для настройки CI/CD сервера GitLab;

`feature.bat` - файл для запуска утилит, автоматизирующих процесс разработки (создание базы данных, хранилища конфигурации и т. д.);

`README.md` - файл с описанием проекта в формате Markdown. Предполагается, что сначала описание подготавливается в файле README.md (мастер), а затем импортируется в confluence через "Вставить разметку -  Вставить Confluence Wiki". Преобразовывать оформление можно через [конвертер разметки](http://chunpu.github.io/markdown2confluence/browser/). "Вставить разметку - Вставить Markdown" в Confluence 6.15.6 работает некорректно, ломая разметку. В более поздних версиях ситуация может измениться;

`sonar-project.properties` - файл с настройками SonarQube Scanner;

## Пример разработки в своей ветке

### Создание окружения для новой feature (новая ветка git)

Открыть консоль CMD и перейти в каталог, где вы хотите разместить выбранный проект:

```bash
cd C:\w\1c\tmp
```

Клонировать проект с удаленного репозитория :

```bash
git clone git@git.a:dev1c/ut_10_3.git
```

Переименовать появившуюся папку с проектом. Новое имя должно совпадать с номером задачи Jira или SRS (получить информацию у TL). Например, DEV1C-4568:

```bash
rename cloned_project DEV1C-4568
```

Перейти в переименованный каталог:

```bash
cd DEV1C-4568
```

Перейти в branch или commit, от которого вы хотите начать свою разработку, например, последний commit ветки основного хранилища (develop).

```bash
git checkout develop
```

Запустите команду создания окружения:

```bash
feature src
```

Открыть созданную базу из списка информационных баз (она уже подключена к новому хранилищу под пользователем Администратор без пароля)

Переименовать пользователя хранилища аналогично вашей учетной записи в основном хранилище (пароль не требуется). Под этим пользователем будут выкладываться изменения в репозиторий.

В результате:

* в каталоге C:\w\1c\tmp\DEV1C-4568\build появится каталог base с файловой базой данных в которую загружена (но не обновлена) конфигурация из папки src проекта;
* в каталоге C:\w\1c\tmp\DEV1C-4568\build появится каталог storage с хранилищем конфигурации, подключенному к файловой базе из каталога base;
* в подключенном хранилище добавлен пользователь Администратор без пароля (ВНИМАНИЕ! Пользователя "Администратор" необходимо переименовать аналогично вашей учетной записи в основном хранилище, пароль не требуется);
* в локальном репозитории C:\w\1c\tmp\DEV1C-4568 будет создана новая ветка feature/DEV1C-4568 с переключением репозитория в эту ветку.
* в списке баз будет зарегистрирована созданная информационная база.

### Выкладывание разработки в удаленный репозиторий

После окончания разработки выполнить конвертацию данных из хранилища 1С в требуемый формат (используется gitsync):

```bash
feature export РазработчикФ_И_О
```

Отправить изменения в удаленный репозиторий:

```bash
git push
```

Выполнить WIP PR (будут задействованы механизмы CI/CD).